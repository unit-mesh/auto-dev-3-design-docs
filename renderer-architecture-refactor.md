# Renderer Architecture Refactor

## ğŸ¯ ç›®æ ‡

é‡æ–°è®¾è®¡æ¸²æŸ“å™¨æ¶æ„ï¼Œè§£å†³å½“å‰æ··ä¹±çš„ç»§æ‰¿å…³ç³»ï¼Œä¸ºCLIã€TUIå’Œæœªæ¥çš„WebUIæä¾›æ¸…æ™°çš„æŠ½è±¡å±‚æ¬¡ã€‚

## ğŸ—ï¸ æ–°æ¶æ„è®¾è®¡

### Kotlinå±‚ (mpp-core)

```
CodingAgentRenderer (interface) - æ ¸å¿ƒæ¸²æŸ“æ¥å£
â”œâ”€â”€ BaseRenderer (abstract class) - é€šç”¨åŠŸèƒ½å®ç°
â”‚   â”œâ”€â”€ é€šç”¨devinå—è¿‡æ»¤é€»è¾‘
â”‚   â”œâ”€â”€ ç›¸ä¼¼æ€§æ£€æµ‹å’Œé‡å¤åˆ†æè­¦å‘Š
â”‚   â”œâ”€â”€ æ¢è¡Œç¬¦æ¸…ç†
â”‚   â””â”€â”€ æµå¼è¾“å‡ºç¼“å†²ç®¡ç†
â”œâ”€â”€ DefaultCodingAgentRenderer (class) - ç®€å•æ§åˆ¶å°å®ç°
â””â”€â”€ RendererType (enum) - æ¸²æŸ“å™¨ç±»å‹æšä¸¾
```

### JSå¯¼å‡ºå±‚ (mpp-core/jsMain)

```
JsCodingAgentRenderer (interface) - JSå‹å¥½çš„æ¸²æŸ“æ¥å£
â”œâ”€â”€ RendererFactory (object) - æ¸²æŸ“å™¨å·¥å‚
â”‚   â”œâ”€â”€ createRenderer() - åˆ›å»ºJSæ¸²æŸ“å™¨é€‚é…å™¨
â”‚   â””â”€â”€ getRendererTypes() - è·å–æ”¯æŒçš„æ¸²æŸ“å™¨ç±»å‹
â””â”€â”€ JsRendererAdapter (class) - Kotlin-JSé€‚é…å™¨
```

### TypeScriptå±‚ (mpp-ui)

```
BaseRenderer (abstract class) - TSåŸºç¡€æ¸²æŸ“å™¨
â”œâ”€â”€ å®ç°JsCodingAgentRendereræ¥å£
â”œâ”€â”€ æä¾›é€šç”¨åŠŸèƒ½ï¼ˆdevinè¿‡æ»¤ã€ç›¸ä¼¼æ€§æ£€æµ‹ç­‰ï¼‰
â”œâ”€â”€ å®šä¹‰æŠ½è±¡æ–¹æ³•ä¾›å­ç±»å®ç°
â””â”€â”€ CliRenderer (class) - CLIä¸“ä¸šæ¸²æŸ“å®ç°
    â”œâ”€â”€ ç»§æ‰¿BaseRenderer
    â”œâ”€â”€ å½©è‰²è¾“å‡ºå’Œæ ¼å¼åŒ–
    â”œâ”€â”€ è¯­æ³•é«˜äº®
    â””â”€â”€ ä¸“ä¸šå·¥å…·æ˜¾ç¤ºæ ¼å¼
```

## ğŸ”„ æ¶æ„ä¼˜åŠ¿

### 1. æ¸…æ™°çš„ç»§æ‰¿å±‚æ¬¡
- **Kotlinæ¥å£** â†’ **æŠ½è±¡åŸºç±»** â†’ **å…·ä½“å®ç°**
- æ¯å±‚èŒè´£æ˜ç¡®ï¼Œé¿å…é‡å¤ä»£ç 

### 2. è·¨å¹³å°ä¸€è‡´æ€§
- Kotlinå’ŒTypeScriptä½¿ç”¨ç›¸åŒçš„æ¥å£å®šä¹‰
- é€šè¿‡é€‚é…å™¨æ¨¡å¼æ— ç¼è¿æ¥

### 3. å¯æ‰©å±•æ€§
- è½»æ¾æ·»åŠ æ–°çš„æ¸²æŸ“å™¨ç±»å‹ï¼ˆTUIã€WebUIï¼‰
- åŸºç¡€åŠŸèƒ½åœ¨åŸºç±»ä¸­å¤ç”¨

### 4. ç±»å‹å®‰å…¨
- å®Œæ•´çš„TypeScriptç±»å‹æ”¯æŒ
- Kotlin-JSäº’æ“ä½œæ€§ä¿è¯

## ğŸ“ ä¸»è¦æ–‡ä»¶

### Kotlinæ ¸å¿ƒ
- `CodingAgentRenderer.kt` - æ ¸å¿ƒæ¥å£å®šä¹‰
- `BaseRenderer.kt` - æŠ½è±¡åŸºç±»å®ç°
- `DefaultCodingAgentRenderer.kt` - é»˜è®¤æ§åˆ¶å°æ¸²æŸ“å™¨

### JSå¯¼å‡º
- `RendererExports.kt` - JSæ¥å£å’Œå·¥å‚
- `JsRendererAdapter` - Kotlin-JSé€‚é…å™¨

### TypeScriptå®ç°
- `BaseRenderer.ts` - TSæŠ½è±¡åŸºç±»
- `CliRenderer.ts` - CLIä¸“ä¸šæ¸²æŸ“å™¨

## ğŸ§ª æµ‹è¯•éªŒè¯

âœ… **æ„å»ºæµ‹è¯•**ï¼šKotlinå’ŒTypeScriptéƒ½æˆåŠŸç¼–è¯‘
âœ… **åŠŸèƒ½æµ‹è¯•**ï¼šCLIå·¥å…·æ­£å¸¸è¿è¡Œï¼Œæ‰€æœ‰åŠŸèƒ½ä¿æŒä¸€è‡´
âœ… **è¾“å‡ºè´¨é‡**ï¼šä¸“ä¸šæ ¼å¼åŒ–è¾“å‡ºï¼Œæ— å¹²æ‰°å†…å®¹
âœ… **æ¶æ„æ¸…æ™°**ï¼šç»§æ‰¿å…³ç³»æ˜ç¡®ï¼Œä»£ç å¤ç”¨è‰¯å¥½

## ğŸš€ æœªæ¥æ‰©å±•

### TUIæ¸²æŸ“å™¨
```typescript
class TuiRenderer extends BaseRenderer {
  // å®ç°äº¤äº’å¼ç»ˆç«¯UI
  // æ”¯æŒé”®ç›˜å¯¼èˆªã€å®æ—¶æ›´æ–°ç­‰
}
```

### Webæ¸²æŸ“å™¨
```typescript
class WebRenderer extends BaseRenderer {
  // å®ç°Webç•Œé¢æ¸²æŸ“
  // æ”¯æŒHTMLè¾“å‡ºã€å®æ—¶æµå¼æ›´æ–°ç­‰
}
```

## ğŸ“ æ€»ç»“

æ–°æ¶æ„æˆåŠŸè§£å†³äº†åŸæœ‰çš„æ··ä¹±ç»§æ‰¿å…³ç³»ï¼Œæä¾›äº†ï¼š
- ğŸ¯ **æ¸…æ™°çš„æŠ½è±¡å±‚æ¬¡**
- ğŸ”„ **è‰¯å¥½çš„ä»£ç å¤ç”¨**
- ğŸš€ **å¼ºå¤§çš„æ‰©å±•èƒ½åŠ›**
- âœ… **å®Œæ•´çš„ç±»å‹å®‰å…¨**

ç°åœ¨å¯ä»¥è½»æ¾æ·»åŠ æ–°çš„æ¸²æŸ“å™¨ç±»å‹ï¼ŒåŒæ—¶ä¿æŒä»£ç çš„æ•´æ´å’Œå¯ç»´æŠ¤æ€§ã€‚
